[Event]
-Name:Quest4_Cutscene
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.On:
	game_CutsceneBegin({_who="Office", _action="CutScene4_finish"});
-Script.Off:
	game_CutsceneEnd({});
	if(gui_isCutSceneWasSkipped()){
		gui_FadeIn();
	}
-Script.In:
	gui_FadeIn();
	actorWait_Timeout(3);
	local Stager = actor_GetFollower(actor_GetActor("ACTOR.AGATA"));
	actorWait_SwitchToAction(Stager,"Cutscene.driver");
	Stager = actor_GetActor(Stager);
	gui_FadeOut();
	actorWait_Timeout(1);
	actor_AttachCamera(Stager);
	actorWait_Timeout(1);
	local dialogFile = core_GetDataPath("text\\quest_cutscenes_dialog.lng");
	local actorAg = actor_GetActor("ACTOR.AGATA");
	actorWait_SwitchToAction(actorAg,"Cutscene.driver");
	gui_ShowDialog(dialogFile, { _section="DIALOG1", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
		while(gui_IsDialogOpen()==true){
		::suspend();
	}
	actor_SendToLocation(actorAg,"CutScene1::Agata");
	actor_SetProfessionRaw(actorAg,"AUTHOR-EXPERT");
	gui_FadeIn();
	actorWait_Timeout(1);
	actor_DetachCamera();
	actorWait_Timeout(1);
	gui_FadeOut();	
	actor_SwitchToAction(thisActor,"Office_script");
	
[Event]
-Name:CutScene4_finish
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.In:
	actor_SendToLocation(actorAg,"CutScene1::Agata");
	actor_SetProfessionRaw(actorAg,"AUTHOR-EXPERT");
	gui_FadeIn();
	actorWait_Timeout(1);
	actor_DetachCamera();
	actorWait_Timeout(1);
	gui_FadeOut();	
	actor_SwitchToAction(thisActor,"Office_script");

[Event]
-Name:Quest5_Cutscene
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.In:
	local actorBo = actor_GetActor("ACTOR.BOB");
	actorWait_SwitchToAction(actorBo,"Cutscene.driver");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.AGATA"),"Cutscene.driver");
	gui_FadeIn();
	actorWait_Timeout(2);
	game_CutsceneBegin({_who="Office", _action="CutScene5_finish", _changeUI=false});
	//создаём коллектибл
	local sTemplateName = "collectible.trash";
	local sTemplateOptions="";
	sTemplateName = "collectible";
	sTemplateOptions=format("collectible_number=%i",core_Rnd(0,3).tointeger());
	local sTrashLocation = "FurniTRASH::TRASH14";
	local newTrash=actor_CreateActor(sTemplateName,sTemplateName.toupper(),{_options=sTemplateOptions,_location=sTrashLocation});
	actor_SetActorEnabled(newTrash, true);
	actor_AddItem(newTrash,"tutorial_arrow_single");
	actor_SetAttribute(newTrash,"IsCollectible",1);
	
	actor_AttachCamera(actorBo);
	actorWait_Timeout(1);
	gui_FadeOut();
	actorWait_Timeout(2);
	local dialogFile = core_GetDataPath("text\\quest_cutscenes_dialog.lng");
	gui_ShowDialog(dialogFile, { _section="DIALOG2", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	gui_ShowDialog(dialogFile, { _section="DIALOG2-2", _close=false, _noMoreIcon=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	location_AttachCamera({_name="FurniTRASH::TRASH14", _time=7});
	actorWait_Timeout(8);
	actor_SwitchToAction(thisActor,"CutScene5_finish");

[Event]
-Name:CutScene5_finish
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.In:
    gui_FadeIn();
	gui_ShowDialog(null,null);
	actorWait_Timeout(2);
	actorWait_SwitchToAction(actor_GetActor("ACTOR.AGATA"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.BOB"),"");
    gui_QuestOpen(6);
	actor_SetAttribute(thisActor,"Quest7Collectibles",10);
    game_CutsceneEnd({});
    actor_DetachCamera();
    actor_SwitchToAction(thisActor,"Office_script");
    gui_FadeOut();

	 
[Event]
-Name:Quest6_Cutscene1
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.On:
	game_CutsceneBegin({_who="Office", _action="Quest6__Cutscene1_finish", _changeUI=false});
-Script.In:
	local actorSh = actor_GetActor("ACTOR.SHEKEL");
	actorWait_SwitchToAction(actorSh,"Cutscene.driver");
	gui_FadeIn();
	actorWait_Timeout(2);
	local sTemplateName = "collectible.trash";
    local sTemplateOptions="";
    sTemplateName = "collectible";
    sTemplateOptions=format("collectible_number=%i",core_Rnd(0,3).tointeger());
    local sTrashLocation = format("FurniTRASH::TRASH%i", core_Rnd(1,20+1).tointeger(),sTemplateOptions);
    local newTrash=actor_CreateActor(sTemplateName,sTemplateName.toupper(),{_options=sTemplateOptions,_location=sTrashLocation});
	
    actor_SetActorEnabled(newTrash, true);
    actor_SetAttribute(newTrash,"IsCollectible",1);
	
	actor_AttachCamera(actorSh);
	actor_SetActorPos(actorSh,"CREATOR::IDEASTABLESHEKEL");
	actorWait_Timeout(1);
	gui_FadeOut();
	actorWait_Timeout(3);
	local dialogFile = core_GetDataPath("text\\quest_cutscenes_dialog.lng");
	actor_AddItem(actorSh,"collectible_item","collectible_number=0");
	gui_ShowDialog(dialogFile, { _section="DIALOG3", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	if (actor_GetAttributeS("Office","QuestName")=="ACTOR.AGATA"){
		gui_ShowDialog(dialogFile, { _section="DIALOG6", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
		}
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	local number = actor_GetAttributeN(thisActor,"Quest7Collectibles")-1;
	local addVars=[];
	addVars.append({name="quest7colleclibles", value=format("%i",number)});
	if(number > 4){
		gui_ShowDialog(dialogFile, { _section="DIALOG6-1", _vars=addVars, _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
		number = 0
	}
	if(number > 1){
		gui_ShowDialog(dialogFile, { _section="DIALOG6-2", _vars=addVars, _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
		number = 0
	}
		if(number > 0){
		gui_ShowDialog(dialogFile, { _section="DIALOG6-3", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
		number = 0
	}
	actor_DelItem(actorSh,"collectible_item","collectible_number=0");
	actor_SwitchToAction(thisActor,"Quest6_Cutscene1_finish");

[Event]
-Name:Quest6_Cutscene1_finish
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.In:
    gui_FadeIn();
	gui_ShowDialog(null,null);
	actorWait_Timeout(2);
	actor_SetAttribute(thisActor,"Quest7Collectibles",actor_GetAttributeN(thisActor,"Quest7Collectibles")-1);
	actorWait_SwitchToAction(actor_GetActor("ACTOR.AGATA"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.SHEKEL"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.BOB"),"");
    game_CutsceneEnd({});
    actor_DetachCamera();
    actor_SwitchToAction(thisActor,"Office_script");
    gui_FadeOut();
	
	
[Event]
-Name:Quest6_Cutscene2
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.On:
	game_CutsceneBegin({_who="Office", _action="Quest6__Cutscene2_finish", _changeUI=false});
-Script.In:
	local actorSh = actor_GetActor("ACTOR.SHEKEL");
	actorWait_SwitchToAction(actorSh,"Cutscene.driver");
	gui_FadeIn();
	actorWait_Timeout(2);
	actor_AttachCamera(ActorSh);
	actor_SetActorPos(actorSh,"CREATOR::IDEASTABLESHEKEL");
	gui_FadeOut();
	actorWait_Timeout(2);
	local dialogFile = core_GetDataPath("text\\quest_cutscenes_dialog.lng");
	actor_AddItem(actorSh,"collectible_item","collectible_number=0");
	gui_ShowDialog(dialogFile, { _section="DIALOG4", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	gui_FadeIn();
	actorWait_Timeout(2);
	actor_DelItem(actorSh,"collectible_item","collectible_number=0");
	actor_SetActorPos(actorSh,"CutScene1::Shekel");
	actor_SetActorPos(actorAg,"CutScene1::Agata");
	actorWait_SwitchToAction(actorAg,"Cutscene.driver");
	actor_SitOnChair(actorAg,"TABLE.AGATASIDE",true);
	actor_SitOnChairX(actorSh,"TABLE.AGATAMAIN",1,true);
	gui_FadeOut();
	actorWait_Timeout(2);
	gui_ShowDialog(dialogFile, { _section="DIALOG5", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	actor_SwitchToAction(thisActor,"Quest6_Cutscene2_finish");
	
[Event]
-Name:Quest6_Cutscene2_finish
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.In:
    gui_FadeIn();
	gui_ShowDialog(null,null);
	actorWait_Timeout(2);
	gui_QuestOpen(7);
	actorWait_SwitchToAction(actor_GetActor("ACTOR.AGATA"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.SHEKEL"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.BOB"),"");
    game_CutsceneEnd({});
    actor_DetachCamera();
    actor_SwitchToAction(thisActor,"Office_script");
    gui_FadeOut();
	
	
[Event]
-Name:Quest7_Cutscene
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.On:
	game_CutsceneBegin({_who="Office", _action="Quest7__Cutscenefinish", _changeUI=false});
-Script.In:
	local actorSh = actor_GetActor("ACTOR.SHEKEL");
	local actorAg = actor_GetActor("ACTOR.AGATA");
	local actorBo = actor_GetActor("ACTOR.BOB");
	actorWait_SwitchToAction(actorSh,"Cutscene.driver.Speed2");
	actorWait_SwitchToAction(actorAg,"Cutscene.driver");
	actorWait_SwitchToAction(actorBo,"Cutscene.driver");
	gui_FadeIn();
	actorWait_Timeout(2);
	actor_AttachCamera(ActorAg);
	actor_DeleteActor();
	if(actor_IsActorExist("Musor68.cwalk.allowDown")!=false){
		actor_DeleteActor("Musor68.cwalk.allowDown");
	}
	if(actor_IsActorExist("Musor66.cwalk.allowDown")!=false){		
		actor_DeleteActor("Musor66.cwalk.allowDown");
	}
	if(actor_IsActorExist("Musor70.cwalk.allowDown")!=false){		
		actor_DeleteActor("Musor70.cwalk.allowDown");
	}
	if(actor_IsActorExist("Musor65.cwalk.allowDown")!=false){		
		actor_DeleteActor("Musor65.cwalk.allowDown");
	}
	actor_SetActorPos(actorSh,"SCENES_QuestCutscenes::DOT3");
	actor_SetActorPos(actorAg,"SCENES_QuestCutscenes::DOT1");
	actor_SetActorPos(actorBo,"SCENES_QuestCutscenes::DOT2");
	actor_OrientBody(actorBo,actorAg);
	actor_OrientBody(actorAg,actorBo);
	gui_FadeOut();
	actorWait_Timeout(2);
	local dialogFile = core_GetDataPath("text\\quest_cutscenes_dialog.lng");
	gui_ShowDialog(dialogFile, { _section="DIALOG7", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	actorWait_Timeout(0.5);
	actor_OrientBody(actorBo,"Furniture::DOT15");
	actorWait_Timeout(1);
	actor_DeleteActor("PLAKAT");
	gui_ShowDialog(dialogFile, { _section="DIALOG7-1", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	actor_OrientBody(actorBo,actorAg);
	actorWait_GoTo(actorSh,"SCENES_QuestCutscenes::DOT4");
	actor_OrientBody(actorSh,actorAg);
	actor_OrientBody(actorAg,actorSh);
	gui_ShowDialog(dialogFile, { _section="DIALOG7-2", _close=true, _dialogBg="\\gui\\comics_interface_dialog.png"});
	while(gui_IsDialogOpen()==true){
		::suspend();
	}
	actor_SwitchToAction(thisActor,"Quest6_Cutscene7_finish");
	
[Event]
-Name:Quest7_Cutscenefinish
-Prq.IsGlobalEvent:0
-Protected:2
-Priority:-1
-Disable.Person.UI:0
-Think.Speed:1
-Script.In:
    gui_FadeIn();
	gui_ShowDialog(null,null);
	actorWait_Timeout(2);
	gui_QuestOpen(8);
	core_EnableNode("techs_button",true);
	actorWait_SwitchToAction(actor_GetActor("ACTOR.AGATA"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.SHEKEL"),"");
	actorWait_SwitchToAction(actor_GetActor("ACTOR.BOB"),"");
    game_CutsceneEnd({});
    actor_DetachCamera();
    actor_SwitchToAction(thisActor,"Office_script");
    gui_FadeOut();